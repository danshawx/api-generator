# C Interface Generator

Generation of C language header files defining the interface to a library is
performed using python and an XML schema. The XML schema describes the interface
to be generated by the python script.

## Schema

The schema is designed to follow as closely as possible the C language syntax
which it is generating.

The schema is defined as an XML document which takes the form.

```xml
<?xml version="1.0"?>
<interface>
    <!-- xml elements describing the API interface -->
</interface>
```

Ordering of tags within the `<interface></interface>` tags are preserved.

### Include Directive

To insert an include directive into the header use the `include` tag. By default
the angle bracket form is generated although this can also be specified
explicitly; this is done using the `form` attribute which can be set to either
`angle` outputting the angle bracket form or `quote` producing the quotation
mark form.

```xml
<include>stddef.h</include>
<include form="angle">stdint.h</include>
<include form="quote">myheader.h</include>
```

Will result in the following include directive being generated.

```c
#include <stddef.h>
#include <stdint.h>
#include "myheader.h"
```

### Macro Definitions

Insertion of macro definition is done using the `define` tag which comes in
three forms. For the first form only the macro name is required, use the `value`
tag to if a value is required; function like macros can be created using the
`param` tag with a name.


```xml
<define>HAVE_FEATURE</define>
<define>PI<value>3.14</value></define>
<define>UNUSED<param>VARIABLE</param><value>(void)VARIABLE;</value></define>
<define>ASSERT<param>CONDITION</param><param>MESSAGE</param>
  <value>if (CONDITION) {
fprintf(stderr, MESSAGE);
abort();
}</value></define>
```

Will generate the following macro definitions.

```
#define TAG
#define PI 3.14
#define UNUSED(VARIABLE) (void)VARIABLE;
#define ASSERT(CONDITION, MESSAGE) \
  if (CONDITION) { \
    fprintf(stderr, MESSAGE); \
    abort(); \
  }
```

Note that new lines in multi line `value` tags will be escaped automatically.

### Structures

Introducing structures is done using the `struct` tag which can be used to
describe forward declarations, empty structures, and structures with member
objects. Providing only the structure name will result in a forward declaration
whilst an empty `member` node results in an empty structure, finally use the
`member` tag with an optional name and a `type` tag to produce a member object.

```xml
<struct>forward_t</struct>
<struct>empty_t<member></member></struct>
<struct>position_t
  <member>x<type>float</type></member>
  <member>y<type>float</type></member>
</struct>
```

This outputs the following set of structure output.

```c
struct forward_decl_t;
struct empty_t {};
struct position_t {
  float x;
  float y;
};
```